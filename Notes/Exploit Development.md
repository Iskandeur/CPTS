Part of the [[Exploitation]] phase, specifically the "Prepare Exploit" step.

Involves creating or modifying code to successfully exploit a vulnerability in the target environment.

## When is it Needed?

- When no public [[Proof-of-Concept (PoC)]] exists for an identified vulnerability.
- When existing [[Proof-of-Concept (PoC)]] code requires significant adaptation for the target (e.g., different offsets, architecture, configuration).
- To bypass specific security controls (e.g., [[Antivirus (AV)]], [[Endpoint Detection and Response (EDR)]]).
- To achieve specific exploitation goals not covered by public exploits (e.g., specific payload delivery, achieving [[Persistence]]).

## Process

- **Deep Vulnerability Understanding:** Requires thorough [[Vulnerability Research]] and understanding of the vulnerability mechanism (e.g., buffer overflows, use-after-free, race conditions, web vulnerabilities like [[SQL Injection (SQLi)]], [[Cross-Site Scripting (XSS)]]).
- **Debugging:** Using debuggers (like `gdb`, `WinDbg`) to analyze application crashes or behavior.
- **Reverse Engineering:** Analyzing binaries or applications to understand internal workings.
- **Shellcoding:** Writing small payloads ([[Shellcode]]) to be executed after successful exploitation.
- **Fuzzing:** Automatically finding vulnerabilities by sending malformed data.
- **Testing:** Iteratively testing the exploit, often in a controlled lab environment mirroring the target.

## Testing Environment

- Crucial to test custom exploits in a safe, **mirrored environment** that replicates the target system as closely as possible (OS version, patch level, application version, configuration).
- Avoids unintended damage to the client's live systems during development.

## Client Communication

- If developing a potentially risky exploit (e.g., for a critical system, potential for instability), **always communicate with the client** as per the [[Rules of Engagement (RoE)]].
- Get explicit permission before attempting high-risk exploits on live systems.
- If permission is denied, document the vulnerability and the potential exploit path in the [[Reporting]] phase.
- > Better to lose time in communication than having to bring a system back online after a failed exploit attempt. 