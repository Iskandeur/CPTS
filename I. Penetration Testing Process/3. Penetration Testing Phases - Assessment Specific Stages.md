## [[Pre-Engagement Phase]]

*See the dedicated note for details on the pre-engagement process, including [[Scoping Questionnaire]], [[Non-Disclosure Agreement (NDA)]], [[Pre-Engagement Meeting]], [[Penetration Testing Proposal]], [[Rules of Engagement (RoE)]], [[Kick-Off Meeting]], and [[Contractors Agreement]].*

## Pre-Engagement

### Overview

- Preparation stage for actual penetration test
- Involves client communication and contractual agreements
- Client specifies testing requirements
- Pentester explains testing methodology

### Essential Components

- Scoping questionnaire
- Pre-engagement meeting
- Kick-off meeting

### NDA Types -> [[Non-Disclosure Agreement (NDA)]]

*See [[Non-Disclosure Agreement (NDA)]] for details.*

### Authorized Personnel

Be careful to know who in the company is permitted to contract us for a penetration test.
Non-exhaustive list of potential persons:

- Chief Executive Officer (CEO)
- Chief Technical Officer (CTO)
- Chief Information Security Officer (CISO)
- Chief Security Officer (CSO)
- Chief Risk Officer (CRO)
- Chief Information Officer (CIO)
- VP of Internal Audit
- Audit Manager
- VP or Director of IT/Information Security

Exceptions can be made in urgent cases (jump into the kick-off meeting, via videoconference for example).

### Documents

| **Document**                                                         | **Timing for Creation**                             |
| :------------------------------------------------------------------- | :-------------------------------------------------- |
| `1. Non-Disclosure Agreement` (`NDA`)                                | `After` Initial Contact                             |
| `2. Scoping Questionnaire`                                           | `Before` the Pre-Engagement Meeting                 |
| `3. Scoping Document`                                                | `During` the Pre-Engagement Meeting                 |
| `4. Penetration Testing Proposal` (`Contract/Scope of Work` (`SoW`)) | `During` the Pre-engagement Meeting                 |
| `5. Rules of Engagement` (`RoE`)                                     | `Before` the Kick-Off Meeting                       |
| `6. Contractors Agreement` (Physical Assessments)                    | `Before` the Kick-Off Meeting                       |
| `7. Reports`                                                         | `During` and `after` the conducted Penetration Test |

> Note: Our client may provide a separate scoping document listing in-scope IP addresses/ranges/URLs and any necessary credentials but this information should also be documented as an appendix in the RoE document.

> **Important Note:** These documents should be reviewed and adapted by a lawyer after they have been prepared.

## [[Scoping Questionnaire]]

*See the dedicated note for details on the Scoping Questionnaire.*

## [[Pre-Engagement Meeting]]

*See the dedicated note for details on the Pre-Engagement Meeting, including the Contract Checklist items which form the basis for the [[Penetration Testing Proposal]].*

## Pre-Engagement Meeting

Once we have an initial idea, we move on to this meeting.
This meeting discusses all relevant and essential components with the customer before the penetration test, explaining them to our customer.
The information we gather during this phase, along with the data collected from the scoping questionnaire, will serve as inputs to the `Penetration Testing Proposal`, also known as the `Contract` or `Scope of Work` (`SoW`).

> We can think of the whole process as a visit to the doctor to inform ourselves regarding the planned examinations.

This phase typically occurs via e-mail and during an online conference call or in-person meeting.

### Contract - Checklist

| Checkpoint                           | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| :----------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `☐ NDA`                              | Non-Disclosure Agreement (NDA) refers to a secrecy contract between the client and the contractor regarding all written or verbal information concerning an order/project. The contractor agrees to treat all confidential information brought to its attention as strictly confidential, even after the order/project is completed. Furthermore, any exceptions to confidentiality, the transferability of rights and obligations, and contractual penalties shall be stipulated in the agreement. The NDA should be signed before the kick-off meeting or at the latest during the meeting before any information is discussed in detail. |
| `☐ Goals`                            | Goals are milestones that must be achieved during the order/project. In this process, goal setting is started with the significant goals and continued with fine-grained and small ones.                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `☐ Scope`                            | The individual components to be tested are discussed and defined. These may include domains, IP ranges, individual hosts, specific accounts, security systems, etc. Our customers may expect us to find out one or the other point by ourselves. However, the legal basis for testing the individual components has the highest priority here.                                                                                                                                                                                                                                                                              |
| `☐ Penetration Testing Type`         | When choosing the type of penetration test, we present the individual options and explain the advantages and disadvantages. Since we already know the goals and scope of our customers, we can and should also make a recommendation on what we advise and justify our recommendation accordingly. Which type is used in the end is the client's decision.                                                                                                                                                                                                                                                                  |
| `☐ Methodologies`                    | Examples: OSSTMM, OWASP, automated and manual unauthenticated analysis of the internal and external network components, vulnerability assessments of network components and web applications, vulnerability threat vectorization, verification and exploitation, and exploit development to facilitate evasion techniques.                                                                                                                                                                                                                                                                                                                  |
| `☐ Penetration Testing Locations`    | External: Remote (via secure VPN) and/or Internal: Internal or Remote (via secure VPN)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| `☐ Time Estimation`                  | For the time estimation, we need the start and the end date for the penetration test. This gives us a precise time window to perform the test and helps us plan our procedure. It is also vital to explicitly ask how time windows the individual attacks (Exploitation / Post-Exploitation / Lateral Movement) are to be carried out. These can be carried out during or outside regular working hours. When testing outside regular working hours, the focus is more on the security solutions and systems that should withstand our attacks.                                                                                             |
| `☐ Third Parties`                    | For the third parties, it must be determined via which third-party providers our customer obtains services. These can be cloud providers, ISPs, and other hosting providers. Our client must obtain written consent from these providers describing that they agree and are aware that certain parts of their service will be subject to a simulated hacking attack. It is also highly advisable to require the contractor to forward the third-party permission sent to us so that we have actual confirmation that this permission has indeed been obtained.                                                                              |
| `☐ Evasive Testing`                  | Evasive testing is the test of evading and passing security traffic and security systems in the customer's infrastructure. We look for techniques that allow us to find out information about the internal components and attack them. It depends on whether our contractor wants us to use such techniques or not.                                                                                                                                                                                                                                                                                                         |
| `☐ Risks`                            | We must also inform our client about the risks involved in the tests and the possible consequences. Based on the risks and their potential severity, we can then set the limitations together and take certain precautions.                                                                                                                                                                                                                                                                                                                                                                                                                 |
| `☐ Scope Limitations & Restrictions` | It is also essential to determine which servers, workstations, or other network components are essential for the client's proper functioning and its customers. We will have to avoid these and must not influence them any further, as this could lead to critical technical errors that could also affect our client's customers in production.                                                                                                                                                                                                                                                                           |
| `☐ Information Handling`             | HIPAA, PCI, HITRUST, FISMA/NIST, etc.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| `☐ Contact Information`              | For the contact information, we need to create a list of each person's name, title, job title, e-mail address, phone number, office phone number, and an escalation priority order.                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| `☐ Lines of Communication`           | It should also be documented which communication channels are used to exchange information between the customer and us. This may involve e-mail correspondence, telephone calls, or personal meetings.                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| `☐ Reporting`                        | Apart from the report's structure, any customer-specific requirements the report should contain are also discussed. In addition, we clarify how the reporting is to take place and whether a presentation of the results is desired.                                                                                                                                                                                                                                                                                                                                                                                                        |
| `☐ Payment Terms`                    | Finally, prices and the terms of payment are explained.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |

The most crucial element of this meeting is the detailed presentation of the penetration test to our client and its focus. As we already know, each piece of infrastructure is unique for the most part, and each client has particular preferences on which they place the most importance. Finding out these priorities is an essential part of this meeting.

> We can think of it as ordering in a restaurant. If we want a medium-rare steak and the chef gives us a well-done steak because he believes it is better, it will not be what we were hoping for. Therefore, we should prioritize our client's wishes and serve the steak as they ordered.

Based on the `Contract Checklist` and the input information shared in scoping, the `Penetration Testing Proposal` (`Contract`) and the associated `Rules of Engagement` (`RoE`) are created. -> See [[Penetration Testing Proposal]] and [[Rules of Engagement (RoE)]]

### ~~Rules of Engagement - Checklist~~ -> [[Rules of Engagement (RoE)]]

*See [[Rules of Engagement (RoE)]] for the detailed checklist.*

## [[Kick-Off Meeting]]

*See the dedicated note for details on the Kick-Off Meeting.*

## Kick-Off Meeting

The kick-off meeting usually occurs at a scheduled time and in-person after signing all contractual documents.

> Features: client POC(s) (from Internal Audit, Information Security, IT, Governance & Risk, etc., depending on the client), client technical support staff (developers, sysadmins, network engineers, etc.), and the penetration testing team (someone in a management role (such as the Practice Lead), the actual penetration tester(s), and sometimes a Project Manager or even the Sales Account Executive or similar)

We also explain that if a critical vulnerability is identified, penetration testing activities will be paused, a vulnerability notification report will be generated, and the emergency contacts will be contacted.

> Typically for an RCE or a SQLi, to allow client to do an emergency fix if necessary

Typical reasons to stop a pentest:

*   A system becomes unresponsive
*   Evidence of illegal activities
*   External Threat Actor detected

We must inform customer of the risks, such as:

*   a lot of potential noise in the logs and potential alerts / alarms.
*   if bruteforce used, potential account lock

they have to inform us immediately if the performed pentest negatively impacts their network

Be mindful of the audience, explain to everyone.
All points related to testing need to be discussed and clarified.
Adapt to the customer.

## [[Contractors Agreement]]

*See the dedicated note for details on the Contractors Agreement, required for [[Physical Security Assessment]]s.*

## Contractors Agreement

If included physical testing, additional contractor's agreement required.
This is, because we go out of the virtual world and a whole new set of laws apply
It's our *get out of jail free* card, in case we get caught in a physical intrusion.

| Checklist                         | Contents                  |
| :-------------------------------- | :------------------------ |
| `☐ Introduction`                  |                           |
| `☐ Contractor`                    |                           |
| `☐ Purpose`                       |                           |
| `☐ Goal`                          |                           |
| `☐ Penetration Testers`           |                           |
| `☐ Contact Information`           |                           |
| `☐ Physical Addresses`            |                           |
| `☐ Building Name`                 |                           |
| `☐ Floors`                        |                           |
| `☐ Physical Room Identifications` |                           |
| `☐ Physical Components`           |                           |
| `☐ Timeline`                      |                           |
| `☐ Notarization`                  |                           |

## Setting Up

*Placeholder: Details on preparing the testing environment, VMs, tools etc. can be added here or linked to a separate Setup note.*

## [[Information Gathering]]

*See the dedicated note [[Information Gathering]] for an overview. Also see specific techniques: [[Open-Source Intelligence (OSINT)]], [[Infrastructure Enumeration]], [[Service Enumeration]], [[Host Enumeration]].*

## [[Vulnerability Assessment]]

*See the dedicated note [[Vulnerability Assessment]] for an overview. Key concepts include [[Analysis Types]], [[Vulnerability Research]], [[Common Vulnerabilities and Exposures (CVE)]], and [[Proof-of-Concept (PoC)]].*

## [[Exploitation]]

*See the dedicated note [[Exploitation]] for an overview. Key activities include [[Exploit Prioritization]] and [[Exploit Development]].*

## [[Post-Exploitation]]

*See the dedicated note [[Post-Exploitation]] for an overview. Key activities include [[Evasive Testing]], [[Information Gathering]] (Internal), [[Pillaging]], [[Vulnerability Assessment]] (Internal), [[Privilege Escalation]], [[Persistence]], and [[Data Exfiltration]].*

## [[Lateral Movement]]

*See the dedicated note [[Lateral Movement]] for an overview. Key activities include [[Pivoting]] / [[Tunneling]], [[Evasive Testing]], [[Information Gathering]] (Internal Recon), [[Vulnerability Assessment]] (Internal), [[Exploitation]] (Internal), and repeating [[Post-Exploitation]] steps on new hosts.*

*Note: This file originally contained detailed descriptions of these phases. The content has been migrated to the individual linked notes as part of the vault restructuring.*